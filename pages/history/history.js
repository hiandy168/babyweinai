var historyList = [
    {
        id: '1', title: '2017-01-01', records: [
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' },
            { datetime: '2017-01-01 17:01', count: 100, unit: 'ml', type: '开水' },
            { datetime: '2017-01-01 17:02', count: 100, unit: 'ml', type: '开水' }
        ]
    },
    {
        id: '2', title: '2017-02-01', records: [
            { datetime: '2017-01-01 17:01', count: 100, unit: 'ml', type: '开水' },
            { datetime: '2017-01-01 17:02', count: 100, unit: 'ml', type: '开水' },
            { datetime: '2017-01-01 17:03', count: 100, unit: 'ml', type: '开水' }
        ]
    },
    {
        id: '3', title: '2017-01-01', records: [
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' },
            { datetime: '2017-01-01 17:01', count: 100, unit: 'ml', type: '开水' },
            { datetime: '2017-01-01 17:02', count: 100, unit: 'ml', type: '开水' }
        ]
    },
    {
        id: '4', title: '2017-02-01', records: [
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' },
            { datetime: '2017-01-01 17:01', count: 100, unit: 'ml', type: '开水' },
            { datetime: '2017-01-01 17:02', count: 100, unit: 'ml', type: '开水' }
        ]
    },
    {
        id: '5', title: '2017-01-01', records: [
            { datetime: '2017-01-01 17:01', count: 100, unit: 'ml', type: '开水' },
            { datetime: '2017-01-01 17:02', count: 100, unit: 'ml', type: '开水' },
            { datetime: '2017-01-01 17:03', count: 100, unit: 'ml', type: '开水' }
        ]
    },
    {
        id: '6', title: '2017-02-01', records: [
            { datetime: '2017-01-01 17:01', count: 100, unit: 'ml', type: '开水' },
            { datetime: '2017-01-01 17:02', count: 100, unit: 'ml', type: '开水' },
            { datetime: '2017-01-01 17:03', count: 100, unit: 'ml', type: '开水' }
        ]
    },
    {
        id: '7', title: '2017-01-01', records: [
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' },
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' },
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' }
        ]
    },
    {
        id: '8', title: '2017-02-01', records: [
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' },
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' },
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' }
        ]
    },
    {
        id: '9', title: '2017-01-01', records: [
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' },
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' },
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' }
        ]
    },
    {
        id: '10', title: '2017-02-01', records: [
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' },
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' },
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' }
        ]
    },
    {
        id: '11', title: '2017-01-01', records: [
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' },
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' },
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' }
        ]
    },
    {
        id: '12', title: '2017-02-01', records: [
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' },
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' },
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' }
        ]
    },
    {
        id: '13', title: '2017-01-01', records: [
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' },
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' },
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' }
        ]
    },
    {
        id: '14', title: '2017-02-01', records: [
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' },
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' },
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' }
        ]
    },
    {
        id: '15', title: '2017-01-01', records: [
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' },
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' },
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' }
        ]
    },
    {
        id: '16', title: '2017-02-01', records: [
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' },
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' },
            { datetime: '2017-01-01 17:00', count: 100, unit: 'ml', type: '开水' }
        ]
    }
];
var repository = require('../../utils/repository.js');
var recordStartX = 0;
Page(
    {
        data: {
            historyList: historyList
        }
        ,
        onLoad: function (options) {
            // 页面初始化 options为页面跳转所带来的参数
            console.log('onload');
        },
        onShow: function () {
            console.log('onshow');
            repository.getRecords((data) => {
                console.log('record length:', data.length);
            });
        },
        historyToggle: function (e) {
            var id = e.currentTarget.id;
            for (var i = 0; i < historyList.length; i++) {
                var item = historyList[i];
                if (item.id === id) {
                    item.open = !item.open;
                } else {
                    item.open = false;
                }
            }
            this.setData({
                historyList: historyList
            });
        }
        ,
        recordStart: function (e) {
            recordStartX = e.touches[0].clientX;
            console.log('startX ', recordStartX);
        }
        ,
        recordMove: function (e) {
            var x = e.touches[0].clientX;
            var mX = recordStartX - x;
            console.log('x ', x);
            console.log('mx ', mX);
            var historyList = this.data.historyList;
            var item = historyList[0];
            var records = item.records;
            records[0].offsetX = 18 - mX;
            this.setData({
                historyList: historyList
            });
        }
        ,
        recordEnd: function (e) {

        }

    }
);